[gd_scene load_steps=25 format=3 uid="uid://cjd7l6c2m6h1r"]

[ext_resource type="Script" path="res://src/reactives/firefly2.gd" id="1_35m0p"]
[ext_resource type="Script" path="res://src/lights/light_register.gd" id="2_6bmaa"]
[ext_resource type="Script" path="res://david/light-animation.gd" id="2_fe7px"]
[ext_resource type="Script" path="res://src/lights/scale_anim.gd" id="4_c6ep3"]
[ext_resource type="Texture2D" uid="uid://dmxghorjvw0v4" path="res://assets/firefly.png" id="4_mh7b5"]
[ext_resource type="Script" path="res://src/reactives/reactive_component.gd" id="5_3nviw"]
[ext_resource type="Shader" path="res://test-tmp.gdshader" id="5_ddrn8"]
[ext_resource type="Texture2D" uid="uid://cextgribwq6d5" path="res://assets/white-square.jpeg" id="6_ymtl8"]

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_j6nee"]
blend_mode = 1

[sub_resource type="Gradient" id="Gradient_6vwl4"]
offsets = PackedFloat32Array(0.4, 0.682927)
colors = PackedColorArray(1, 1, 1, 1, 0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_br8xq"]
gradient = SubResource("Gradient_6vwl4")
width = 256
height = 256
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="AtlasTexture" id="AtlasTexture_qyy1s"]
atlas = ExtResource("4_mh7b5")
region = Rect2(0, 0, 20, 19)

[sub_resource type="AtlasTexture" id="AtlasTexture_nhh7x"]
atlas = ExtResource("4_mh7b5")
region = Rect2(20, 0, 20, 19)

[sub_resource type="AtlasTexture" id="AtlasTexture_rr88v"]
atlas = ExtResource("4_mh7b5")
region = Rect2(0, 30, 20, 19)

[sub_resource type="AtlasTexture" id="AtlasTexture_p5a2m"]
atlas = ExtResource("4_mh7b5")
region = Rect2(20, 30, 20, 19)

[sub_resource type="SpriteFrames" id="SpriteFrames_mm8xg"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_qyy1s")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_nhh7x")
}],
"loop": true,
"name": &"off",
"speed": 2.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_rr88v")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_p5a2m")
}],
"loop": true,
"name": &"on",
"speed": 2.0
}]

[sub_resource type="Gradient" id="Gradient_k165v"]
offsets = PackedFloat32Array(0, 0.721254)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_qun82"]
gradient = SubResource("Gradient_k165v")
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="Gradient" id="Gradient_hy2yg"]
offsets = PackedFloat32Array(0, 0.658009)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_avcy2"]
gradient = SubResource("Gradient_hy2yg")
width = 80
height = 80
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_hf64g"]
shader = ExtResource("5_ddrn8")
shader_parameter/light_color = Vector3(0, 255, 0)
shader_parameter/brightness = 1.0
shader_parameter/attenuation_strength = 0.553
shader_parameter/intensity = 2.0
shader_parameter/max_brightness = 1.0
shader_parameter/light_texture = SubResource("GradientTexture2D_avcy2")

[sub_resource type="Gradient" id="Gradient_1pyoa"]
offsets = PackedFloat32Array(0, 0.731707)
colors = PackedColorArray(1, 1, 1, 1, 0, 0, 0, 1)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_wijv8"]
gradient = SubResource("Gradient_1pyoa")
width = 171
height = 171
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="CircleShape2D" id="CircleShape2D_0vyp0"]
resource_local_to_scene = true
radius = 298.06

[node name="Firefly" type="Node2D"]
script = ExtResource("1_35m0p")
distance = 200.0
speed = 40.0
pause = 0.5
oscilation = 7.0

[node name="Light" type="Sprite2D" parent="."]
visible = false
material = SubResource("CanvasItemMaterial_j6nee")
texture = SubResource("GradientTexture2D_br8xq")
script = ExtResource("2_fe7px")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
sprite_frames = SubResource("SpriteFrames_mm8xg")
animation = &"on"

[node name="OverLight" type="Node2D" parent="AnimatedSprite2D"]
unique_name_in_owner = true
visible = false
position = Vector2(0.6, 1.5)
scale = Vector2(0.3, 0.3)
script = ExtResource("4_c6ep3")

[node name="YellowLight" type="PointLight2D" parent="AnimatedSprite2D/OverLight"]
position = Vector2(4.66667, 15)
scale = Vector2(3.33333, 3.33333)
color = Color(1, 1, 0, 1)
energy = 2.16
texture = SubResource("GradientTexture2D_qun82")

[node name="Green" type="Sprite2D" parent="AnimatedSprite2D/OverLight"]
material = SubResource("ShaderMaterial_hf64g")
position = Vector2(4.66667, 15)
texture = ExtResource("6_ymtl8")

[node name="OffLight" type="Sprite2D" parent="AnimatedSprite2D"]
visible = false
material = SubResource("CanvasItemMaterial_j6nee")
position = Vector2(2, 5)
scale = Vector2(0.2, 0.2)
texture = SubResource("GradientTexture2D_wijv8")
script = ExtResource("2_6bmaa")

[node name="ReactiveComponent" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 64
script = ExtResource("5_3nviw")
song_condition = "light"

[node name="CollisionShape2D" type="CollisionShape2D" parent="ReactiveComponent"]
visible = false
shape = SubResource("CircleShape2D_0vyp0")

[node name="Timer" type="Timer" parent="."]

[connection signal="activate" from="ReactiveComponent" to="." method="_on_reactive_component_activate"]
[connection signal="deactivate" from="ReactiveComponent" to="." method="_on_reactive_component_deactivate"]
