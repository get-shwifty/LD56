[gd_scene load_steps=23 format=3 uid="uid://cjd7l6c2m6h1r"]

[ext_resource type="Script" path="res://src/reactives/firefly2.gd" id="1_35m0p"]
[ext_resource type="Script" path="res://david/light-animation.gd" id="2_fe7px"]
[ext_resource type="Texture2D" uid="uid://o8w8xks0fgpk" path="res://light-gradient.tres" id="3_djwwt"]
[ext_resource type="Texture2D" uid="uid://dmxghorjvw0v4" path="res://assets/firefly.png" id="4_mh7b5"]
[ext_resource type="Script" path="res://src/reactives/reactive_component.gd" id="5_3nviw"]
[ext_resource type="Shader" path="res://test-tmp.gdshader" id="5_ddrn8"]
[ext_resource type="Texture2D" uid="uid://cextgribwq6d5" path="res://assets/white-square.jpeg" id="6_ymtl8"]

[sub_resource type="CanvasItemMaterial" id="CanvasItemMaterial_j6nee"]
blend_mode = 2

[sub_resource type="Gradient" id="Gradient_wcc1a"]
offsets = PackedFloat32Array(0.317073, 0.6)
colors = PackedColorArray(0, 0, 0, 1, 0, 0, 0, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_br8xq"]
gradient = SubResource("Gradient_wcc1a")
width = 256
height = 256
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="Gradient" id="Gradient_cw16w"]
offsets = PackedFloat32Array(0, 0.721254)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_qun82"]
gradient = SubResource("Gradient_cw16w")
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="AtlasTexture" id="AtlasTexture_qyy1s"]
atlas = ExtResource("4_mh7b5")
region = Rect2(0, 0, 20, 19)

[sub_resource type="AtlasTexture" id="AtlasTexture_nhh7x"]
atlas = ExtResource("4_mh7b5")
region = Rect2(20, 0, 20, 19)

[sub_resource type="AtlasTexture" id="AtlasTexture_rr88v"]
atlas = ExtResource("4_mh7b5")
region = Rect2(0, 30, 20, 19)

[sub_resource type="AtlasTexture" id="AtlasTexture_p5a2m"]
atlas = ExtResource("4_mh7b5")
region = Rect2(20, 30, 20, 19)

[sub_resource type="SpriteFrames" id="SpriteFrames_mm8xg"]
animations = [{
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_qyy1s")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_nhh7x")
}],
"loop": true,
"name": &"off",
"speed": 2.0
}, {
"frames": [{
"duration": 1.0,
"texture": SubResource("AtlasTexture_rr88v")
}, {
"duration": 1.0,
"texture": SubResource("AtlasTexture_p5a2m")
}],
"loop": true,
"name": &"on",
"speed": 2.0
}]

[sub_resource type="Gradient" id="Gradient_hy2yg"]
offsets = PackedFloat32Array(0, 0.658009)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0)

[sub_resource type="GradientTexture2D" id="GradientTexture2D_avcy2"]
gradient = SubResource("Gradient_hy2yg")
width = 80
height = 80
fill = 1
fill_from = Vector2(0.5, 0.5)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_hf64g"]
shader = ExtResource("5_ddrn8")
shader_parameter/light_color = Vector3(0, 255, 0)
shader_parameter/brightness = 1.0
shader_parameter/attenuation_strength = 0.553
shader_parameter/intensity = 2.0
shader_parameter/max_brightness = 1.0
shader_parameter/light_texture = SubResource("GradientTexture2D_avcy2")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_u01ql"]
shader = ExtResource("5_ddrn8")
shader_parameter/light_color = Vector3(150, 255, 0)
shader_parameter/brightness = 1.0
shader_parameter/attenuation_strength = 0.797
shader_parameter/intensity = 0.3
shader_parameter/max_brightness = 1.0
shader_parameter/light_texture = ExtResource("3_djwwt")

[sub_resource type="CircleShape2D" id="CircleShape2D_0vyp0"]
resource_local_to_scene = true
radius = 298.06

[node name="Firefly" type="Node2D"]
script = ExtResource("1_35m0p")
distance = 200.0
speed = 40.0
pause = 0.5
oscilation = 7.0

[node name="Light" type="Node2D" parent="."]
position = Vector2(2, 9)
script = ExtResource("2_fe7px")

[node name="Light" type="Sprite2D" parent="Light"]
material = SubResource("CanvasItemMaterial_j6nee")
texture = SubResource("GradientTexture2D_br8xq")

[node name="PointLight2D" type="PointLight2D" parent="Light/Light"]
visible = false
color = Color(1, 1, 0, 1)
texture = SubResource("GradientTexture2D_qun82")

[node name="AnimatedSprite2D" type="AnimatedSprite2D" parent="."]
z_index = 2
sprite_frames = SubResource("SpriteFrames_mm8xg")
animation = &"on"

[node name="GreenLight" type="Sprite2D" parent="AnimatedSprite2D"]
z_index = 1
material = SubResource("ShaderMaterial_hf64g")
position = Vector2(2, 5)
scale = Vector2(0.3, 0.3)
texture = ExtResource("6_ymtl8")

[node name="LightBackground" type="Sprite2D" parent="AnimatedSprite2D/GreenLight"]
visible = false
z_index = -2
material = SubResource("ShaderMaterial_u01ql")
scale = Vector2(3, 3)
texture = ExtResource("6_ymtl8")

[node name="ReactiveComponent" type="Area2D" parent="."]
collision_layer = 0
collision_mask = 64
script = ExtResource("5_3nviw")
song_condition = "light"

[node name="CollisionShape2D" type="CollisionShape2D" parent="ReactiveComponent"]
visible = false
shape = SubResource("CircleShape2D_0vyp0")

[node name="Timer" type="Timer" parent="."]

[connection signal="activate" from="ReactiveComponent" to="." method="_on_reactive_component_activate"]
[connection signal="deactivate" from="ReactiveComponent" to="." method="_on_reactive_component_deactivate"]
